nodes:
  - id: mofa-prompt-input
    path: dynamic
    outputs:
      - control

  - id: primespeech-tts
    # build: pip install -e ../../../libs/dora-common -e ../../../node-hub/dora-primespeech  # DISABLED: package already installed via conda
    path: dora-primespeech
    inputs:
      text: mofa-prompt-input/control
    outputs:
      - audio
      - status
      - segment_complete
      - log
    env:
      TRANSFORMERS_OFFLINE: "1"
      HF_HUB_OFFLINE: "1"
      VOICE_NAME: "Doubao"
      PRIMESPEECH_MODEL_DIR: $HOME/.dora/models/primespeech
      TEXT_LANG: zh
      PROMPT_LANG: zh
      TOP_K: 5
      TOP_P: 1.0
      TEMPERATURE: 1.0
      SPEED_FACTOR: 1.1
      FRAGMENT_INTERVAL: "0.1"
      USE_GPU: false
      NUM_THREADS: 4
      RETURN_FRAGMENT: "false"
      LOG_LEVEL: DEBUG
      ENABLE_INTERNAL_SEGMENTATION: "true"
      TTS_MAX_SEGMENT_LENGTH: "100"
      TTS_MIN_SEGMENT_LENGTH: "20"

  - id: mofa-audio-player
    path: dynamic
    inputs:
      audio: primespeech-tts/audio
    outputs:
      - buffer_status
